{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
        <link rel="stylesheet" href="{% static 'css/color.css' %}">
{% endblock %}

{% block title %}{{ event.name }} ã®è©³ç´°{% endblock %}

{% block content %}
<h1>{{ event.name }} ã®è©³ç´°</h1>

<div class="mb-3 event-meta">
    <p><strong>é–‹å‚¬æœŸé–“:</strong> {{ event.start_date }} ã€œ {{ event.end_date }}</p>
    <p><strong>æ¦‚è¦:</strong><br>{{ event.description|linebreaks }}</p>
    {% if event.official_url %}
        <p><strong>å…¬å¼ã‚µã‚¤ãƒˆ:</strong> <a href="{{ event.official_url }}" target="_blank">{{ event.official_url }}</a></p>
    {% endif %}
</div>

<h4>é–‹å‚¬æ—¥ç¨‹ã¨å‡ºæ¼”è€…</h4>
{% for day, performances in day_performances %}
    <div class="mb-3 event-day-block">
        <h5>{{ day.date }} @ {{ day.venue }}</h5>
        {% if performances %}
            <p><strong>å‡ºæ¼”è€…ï¼ˆ{{ performances|length }}çµ„ï¼‰:</strong><br>
                {% for perf in performances %}
                    <a href="{% url 'festival:artist_detail' perf.artist.pk %}">{{ perf.artist.name }}</a>{% if not forloop.last %} / {% endif %}
                {% endfor %}<br>
                <a href="{% url 'festival:create_playlist' %}?event_day={{ day.id }}" class="btn btn-success mt-3">
                    ğŸ§ ã“ã®æ—¥ç¨‹ã®ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’ä½œæˆ
                </a>
            </p>
        {% else %}
            <p class="text-muted">å‡ºæ¼”è€…æœªç™»éŒ²</p>
        {% endif %}
        {% if request.user.is_staff %}
            <a href="{% url 'festival:edit_event_day_performances' day.id %}" class="btn btn-sm btn-outline-secondary">å‡ºæ¼”è€…ã‚’ç·¨é›†</a>
        {% endif %}
    </div>
{% empty %}
    <p class="text-muted">æ—¥ç¨‹ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
{% endfor %}

{% if request.user.is_staff %}
    <a href="{% url 'festival:register_event_day' %}?event_id={{ event.id }}" class="btn btn-secondary">ã“ã®ã‚¤ãƒ™ãƒ³ãƒˆã«å‡ºæ¼”è€…ã‚’ç™»éŒ²</a>
{% endif %}
<a href="{% url 'festival:fes_event_list' %}" class="btn btn-primary mt-3">ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ã«æˆ»ã‚‹</a>
{% endblock %}