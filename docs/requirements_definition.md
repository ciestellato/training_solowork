既存モデルを踏まえた上で、**プレイリスト作成機能の要件定義**を以下の4つの観点で整理しました：

---

## 🎯 目的（What & Why）

- **出演アーティストを選択してSpotifyプレイリストを生成できる機能を提供する**
- ユーザーがフェスやイベントの予習・復習に活用できるようにする
- 将来的にはログイン機能と連携し、ユーザーごとのプレイリスト保存にも対応予定

---

## 🧩 機能構成（How）

### 🔹 対象モデルの活用
既存の `Artist`, `EventDay`, `Performance` モデルを活用して、出演者選択を可能にする。

### 🔹 プレイリスト作成機能の流れ

| ステップ | 内容 |
|----------|------|
| ① イベント日程を選択 | `EventDay` を選択（または一覧表示） |
| ② 出演アーティストを選択 | `Performance` から `artist` を抽出し、チェックボックスで選択 |
| ③ プレイリスト生成 | 選択されたアーティストの `spotify_id` を使って代表曲を取得 |
| ④ 結果表示 | 曲名・アーティスト名・Spotifyリンクを一覧表示（テンプレート） |
| ⑤ （任意）SpotifyプレイリストURLを生成 | SpotipyでユーザーのSpotifyアカウントにプレイリストを作成（将来的） |

---

## 🛠️ 技術要素

| 要素 | 内容 |
|------|------|
| API連携 | Spotify Web API（`tracks`, `search`, `audio-features`） |
| ライブラリ | `spotipy`, `requests`, `python-dotenv` |
| ビュー | `create_playlist_view`（GET: 選択画面 / POST: プレイリスト生成） |
| テンプレート | `playlist_create.html`, `playlist_result.html` |
| フォーム | `PlaylistForm`（出演者選択用） |
| ユーティリティ | `get_top_tracks(spotify_id)` などの関数を `spotify_utils.py` に分離 |

---

## ✅ 実装対象（Deliverables）

| 種類 | 内容 |
|------|------|
| Djangoビュー | 出演者選択 → プレイリスト生成 → 結果表示 |
| フォーム | 出演者選択用フォーム（チェックボックス） |
| テンプレート | プレイリスト作成画面・結果表示画面 |
| Spotify連携 | アーティストの代表曲取得（`top-tracks` or `search`） |
| ユーティリティ | Spotify API呼び出し関数群（エラーハンドリング付き） |

---

## 🔮 今後の拡張案

- ログイン機能と連携し、ユーザーごとの「お気に入りアーティスト」保存
- Spotifyアカウントと連携して、実際のプレイリストをSpotify上に作成
- プレイリストの共有リンク生成
- ジャンルや人気度によるフィルタリング

---
